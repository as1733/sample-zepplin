{"paragraphs":[{"text":"%livy2.pyspark\na=sc.textFile('/user/upkar.yadav91412/test_b.csv')\nb=a.take(10)\nfor line in b:\n print(line)","user":"upkar.yadav91412","dateUpdated":"2019-02-20T14:59:23+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537178821283_-1439157571","id":"20180917-153701_1072831236","dateCreated":"2018-09-17T15:37:01+0530","dateStarted":"2019-02-20T14:59:23+0530","dateFinished":"2019-02-20T14:59:24+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:37101"},{"text":"%livy2.pyspark3\na=sc.textFile('/user/upkar.yadav91412/test_b.csv').map(lambda line: line.split(\";\"))\nb=a.toDF().createOrReplaceTempView(\"empl\")\nc=spark.sql(\"select * from empl\").show() ","user":"upkar.yadav91412","dateUpdated":"2019-02-20T14:59:16+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537778137186_360784095","id":"20180924-140537_770684195","dateCreated":"2018-09-24T14:05:37+0530","dateStarted":"2019-02-20T14:59:16+0530","dateFinished":"2019-02-20T14:59:19+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37102"},{"text":"%livy2.pyspark\nA1=sc.textFile('/user/upkar.yadav91412/test_b.csv')\nnumAs = A1.filter(lambda s: 'married' in s).count()\nnumBs = A1.filter(lambda s: 'single' in s).count()\nprint \"Married count: %i, Single count b: %i\" % (numAs, numBs)","user":"upkar.yadav91412","dateUpdated":"2019-01-31T11:01:23+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537178905563_-1828404325","id":"20180917-153825_144327160","dateCreated":"2018-09-17T15:38:25+0530","dateStarted":"2019-01-31T11:01:23+0530","dateFinished":"2019-01-31T11:01:24+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37103"},{"text":"%livy2.pyspark\ndata = spark.sql(\"select skp_application,skp_client,amt_income_main from bdp_rl_dm_uwi.ft_application_at\")\ndata1=data.filter(\"amt_income_main>30000\").show()","user":"upkar.yadav91412","dateUpdated":"2019-01-22T16:38:17+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537180962107_-1021501185","id":"20180917-161242_157751248","dateCreated":"2018-09-17T16:12:42+0530","dateStarted":"2019-01-22T16:38:17+0530","dateFinished":"2019-01-22T16:38:49+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37104"},{"text":"%livy2.pyspark\ndf = spark.sql(\"select cuid,src_name \\\n,sum(case when elmt_name = 'yodfetchreportresponse_yodambdetails_yoditem[2]_yodminbalance' then elmt_val) yodlee_minimum_balance4 \\\nfrom bdp_rl_d_rcmxml.rcmxml_parsed_resp where src_name='YODLEE' and part_date=20181005\").createOrReplaceTempView(\"paytm\")\ndf1=spark.sql(\"select src_name,count(*) from paytm where act_active_defined = 1\").show()","user":"upkar.yadav91412","dateUpdated":"2019-01-24T16:50:20+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537433491088_-1034993374","id":"20180920-142131_703546015","dateCreated":"2018-09-20T14:21:31+0530","dateStarted":"2018-12-04T13:14:27+0530","dateFinished":"2018-12-04T13:14:50+0530","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37105"},{"title":"ambdetail","text":"%livy2.pyspark\ndf = spark.sql(\"select cuid ,part_date as score_date,sum(case when elmt_name = 'yodfetchreportresponse_yodambdetails_yoditem[2]_yodminbalance' \\\nthen cast(elmt_val as float) end) yodlee_minimum_balance4 \\\nfrom bdp_rl_d_rcmxml.rcmxml_parsed_resp where src_name='YODLEE' \\\n and part_date >20181001 group by cuid,part_date order by part_date \")\ndf.show()","user":"upkar.yadav91412","dateUpdated":"2019-02-01T17:52:42+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537867922614_-1557278124","id":"20180925-150202_1688168540","dateCreated":"2018-09-25T15:02:02+0530","dateStarted":"2019-02-01T17:52:42+0530","dateFinished":"2019-02-01T17:56:03+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37106"},{"title":"CRIF hit count","text":"%livy2.pyspark\ndf = spark.sql(\"select resp_id \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val is null then 1 else 0 end) NO_SCORE \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val < 0 then 1 else 0 end) ZERO_SCORE \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val >= 0 and elmt_val <= 10 then 1 else 0 end) ONETOTENSCORE \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val > 10 then 1 else 0 end) GREATERTHANTEN_SCORE \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val NOT IN ('11','12','13','14','15','16','17','18') then 1 else 0 end) HIT \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val IN ('11','12','13','14','15','16','17','18') then 1 else 0 end) NOHIT \\\nfrom bdp_rl_d_rcmxml.rcmxml_parsed_resp where src_name='CRIF'  \\\nand part_date>=20180801 and part_date<=20180831 group by resp_id\").createOrReplaceTempView(\"Test1\")\ndf1=spark.sql(\"select count(*) from Test1 where HIT=1\").show()\n","user":"upkar.yadav91412","dateUpdated":"2018-11-27T16:33:02+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537868858050_-811463810","id":"20180925-151738_199378760","dateCreated":"2018-09-25T15:17:38+0530","dateStarted":"2018-11-27T16:33:02+0530","dateFinished":"2018-11-27T16:36:51+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37107"},{"title":"EQUIFAX-hit count","text":"%livy2.pyspark\ndf = spark.sql(\"select resp_id \\\n,sum(case when elmt_name = 'schinquiryresponse_schinquiryresponseheader_schhitcode' and elmt_val in ('10','11') then 1 else 0 end) HIT \\\nfrom bdp_rl_d_rcmxml.rcmxml_parsed_resp where src_name='EQUIFAX' \\\nand part_date>=20180901 and part_date<=20180930 group by resp_id\").createOrReplaceTempView(\"TestE\") \ndf1=spark.sql(\"select count(*) from TestE where HIT=1\").show()","user":"upkar.yadav91412","dateUpdated":"2018-10-10T14:44:39+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538039953705_-1381079201","id":"20180927-144913_992630913","dateCreated":"2018-09-27T14:49:13+0530","dateStarted":"2018-10-10T14:44:39+0530","dateFinished":"2018-10-10T15:03:24+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37108"},{"title":"EICB hit count","text":"%livy2.pyspark\ndf = spark.sql(\"select resp_id \\\n,sum(case when elmt_name = 'processresponse_processreturn_inprofileresponse_score_bureauscore' and elmt_val > 0 then 1 else 0 end) score_count \\\n,sum(case when elmt_name = 'processresponse_processreturn_inprofileresponse_matchresult_exactmatch' and elmt_val IN ('Y') then 1 else 0 end) match_count \\\n,sum(case when elmt_name = 'processresponse_processreturn_inprofileresponse_usermessage_usermessagetext' and elmt_val = 'Normal Response' then 1 else 0 end) resp_count \\\nfrom bdp_rl_d_rcmxml.rcmxml_parsed_resp where src_name='EICB' \\\nand part_date>=20181001 and part_date<=20181007 group by resp_id\").createOrReplaceTempView(\"TestEI\") \ndf1=spark.sql(\"select count(*) from TestEI where score_count=1 and match_count=1 and resp_count = 1\").show()\n\n","user":"upkar.yadav91412","dateUpdated":"2018-10-09T12:20:51+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537877884964_917080531","id":"20180925-174804_322493483","dateCreated":"2018-09-25T17:48:04+0530","dateStarted":"2018-10-09T12:20:51+0530","dateFinished":"2018-10-09T12:26:40+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37109"},{"text":"%livy2.pyspark\ndf = spark.sql(\"select resp_id \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val is null then 1 else 0 end) NO_SCORE \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val < 0 then 1 else 0 end) ZERO_SCORE \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val >= 0 and elmt_val <= 10 then 1 else 0 end) ONETOTENSCORE \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val > 10 then 1 else 0 end) GREATERTHANTEN_SCORE \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val NOT IN ('11','12','13','14','15','16','17','18') then 1 else 0 end) HIT \\\n,sum(case when elmt_name = 'crifindvreportfile_crifindvreports_crifindvreport_crifscores_crifscore_crifscorevalue' and elmt_val IN ('11','12','13','14','15','16','17','18') then 1 else 0 end) NOHIT \\\nfrom bdp_rl_d_rcmxml.rcmxml_parsed_resp where src_name='CRIF'  \\\nand part_date>=20190129 group by resp_id\").coalesce(1).write.csv('/user/upkar.yadav91412/crif_sample2_data.csv')\n\n","user":"upkar.yadav91412","dateUpdated":"2019-01-29T17:28:36+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"src_name":"string","part_date":"string","resp_count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","isDateFormat":false,"lineWithFocus":false,"forceY":true},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false}},"commonSetting":{},"keys":[{"name":"part_date","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"resp_count","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537878794354_282949742","id":"20180925-180314_338653345","dateCreated":"2018-09-25T18:03:14+0530","dateStarted":"2019-01-29T17:28:36+0530","dateFinished":"2019-01-29T17:28:59+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37110"},{"title":"Nexmo","text":"%livy2.pyspark\ndf = spark.sql(\"select resp_id \\\n,max(case when elmt_name like '%v1nexmoresponse_v1lookupoutcome_content%' and elmt_val like '%Success%' then 1 else 0 end) success_count \\\nfrom bdp_rl_d_rcmxml.rcmxml_parsed_resp where src_name='NEXMO' \\\nand part_date>=20181001 and part_date<=20181007 group by resp_id\").createOrReplaceTempView(\"TestNX\")\ndf1=spark.sql(\"select count(*) from TestNX where success_count=1\").show()\n","user":"upkar.yadav91412","dateUpdated":"2018-10-09T12:26:46+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537944357780_-1239879859","id":"20180926-121557_1814965148","dateCreated":"2018-09-26T12:15:57+0530","dateStarted":"2018-10-09T12:26:46+0530","dateFinished":"2018-10-09T12:31:13+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37111"},{"title":"nsdl","text":"%livy2.pyspark\ndf = spark.sql(\"select resp_id \\\n,max(case when elmt_name like '%onlnsdlresponse_onlreturncode%' and elmt_val > 0 then 1 else 0 end) success_count \\\nfrom bdp_rl_d_rcmxml.rcmxml_parsed_resp where src_name='NSDL' \\\nand part_date>=20180901 and part_date<=20180930 group by resp_id\").createOrReplaceTempView(\"TestNS\")\ndf1=spark.sql(\"select count(*) from TestNS where success_count=1\").show()","user":"upkar.yadav91412","dateUpdated":"2018-10-09T13:18:53+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538647880346_-1187336145","id":"20181004-154120_1421326661","dateCreated":"2018-10-04T15:41:20+0530","dateStarted":"2018-10-09T13:18:53+0530","dateFinished":"2018-10-09T13:20:47+0530","status":"ABORT","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37112"},{"text":"%livy2.pyspark\ndf = spark.sql(\"select part_date,count(distinct(resp_id)) from bdp_rl_d_rcmxml.rcmxml_parsed_resp where src_name='YODLEE' \\\nand part_date>=20180920 group by part_date order by part_date\")\ndf.show()","user":"upkar.yadav91412","dateUpdated":"2018-10-25T11:52:55+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539068478091_1329362463","id":"20181009-123118_1596266031","dateCreated":"2018-10-09T12:31:18+0530","dateStarted":"2018-10-25T11:52:55+0530","dateFinished":"2018-10-25T11:54:38+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37113"},{"title":"download","text":"%livy2.pyspark\ndf = spark.sql(\"select xml_value from bdp_rl_d_rcmxml.rcmxml_raw_resp where src_name='EQUIFAX' \\\nand part_date=20190126 and cuid in (8675882)\").coalesce(1).write.csv('/user/upkar.yadav91412/eq3.txt')","user":"upkar.yadav91412","dateUpdated":"2019-01-29T18:38:29+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539072401306_-341318706","id":"20181009-133641_1944297323","dateCreated":"2018-10-09T13:36:41+0530","dateStarted":"2019-01-29T18:38:29+0530","dateFinished":"2019-01-29T18:38:45+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37114"},{"text":"%livy2.pyspark\ndf=spark.sql(\"select xml_value from bdp_rl_d_rcmxml.rcmxml_raw_resp where src_name='EQUIFAX' \")","user":"upkar.yadav91412","dateUpdated":"2019-01-29T18:20:38+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539077605866_-1621086298","id":"20181009-150325_1499793761","dateCreated":"2018-10-09T15:03:25+0530","dateStarted":"2018-11-27T14:59:11+0530","dateFinished":"2018-11-27T14:59:12+0530","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37115"},{"text":"%livy2.pyspark\nfrom pyspark.sql import *\nEmployee = Row(\"firstName\", \"lastName\", \"email\", \"salary\")\nemployee1 = Employee('Basher', 'armbrust', 'bash@edureka.co', 100000)\nemployee2 = Employee('Daniel', 'meng', 'daniel@stanford.edu', 120000 )\nemployee3 = Employee('Muriel', None, 'muriel@waterloo.edu', 140000 )\nemployee4 = Employee('Rachel', 'wendell', 'rach_3@edureka.co', 160000 )\nemployee5 = Employee('Zach', 'galifianakis', 'zach_g@edureka.co', 160000 )\nprint(Employee[0])\nprint(employee3)\ndepartment1 = Row(id='123456', name='HR')\ndepartment2 = Row(id='789012', name='OPS')\ndepartment3 = Row(id='345678', name='FN')\ndepartment4 = Row(id='901234', name='DEV')\nprint(department3)","user":"upkar.yadav91412","dateUpdated":"2018-10-26T13:56:01+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539171288360_2080943896","id":"20181010-170448_570593167","dateCreated":"2018-10-10T17:04:48+0530","dateStarted":"2018-10-26T13:55:49+0530","dateFinished":"2018-10-26T13:55:50+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37116"},{"text":"%livy2.pyspark\na=spark.sql(\"sc.version\")","user":"upkar.yadav91412","dateUpdated":"2018-12-26T11:46:17+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540192609390_-436602864","id":"20181022-124649_1893788699","dateCreated":"2018-10-22T12:46:49+0530","dateStarted":"2018-12-26T11:46:17+0530","dateFinished":"2018-12-26T11:46:18+0530","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37117"},{"text":"%livy2.pyspark3\ndf=spark.sql(\"show databases\").show()","user":"upkar.yadav91412","dateUpdated":"2018-11-14T16:24:05+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540895152114_-1082254326","id":"20181030-155552_1290843702","dateCreated":"2018-10-30T15:55:52+0530","dateStarted":"2018-11-14T16:26:30+0530","dateFinished":"2018-11-14T16:55:41+0530","status":"ABORT","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37118"},{"text":"%livy2.pyspark\ndf=spark.sql(\"use bdp_rl_d_rcmxml\")","user":"upkar.yadav91412","dateUpdated":"2018-11-14T14:59:25+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540895230835_1275752792","id":"20181030-155710_1981876882","dateCreated":"2018-10-30T15:57:10+0530","dateStarted":"2018-11-14T14:59:25+0530","dateFinished":"2018-11-14T14:59:26+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37119"},{"text":"%livy2.pyspark3\na=spark.sql(\"show databases\").show()","user":"upkar.yadav91412","dateUpdated":"2018-11-14T11:58:21+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540895533292_-1697254898","id":"20181030-160213_1304269730","dateCreated":"2018-10-30T16:02:13+0530","dateStarted":"2018-11-14T11:58:21+0530","dateFinished":"2018-11-14T11:58:22+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37120"},{"text":"%livy2.pyspark3\nimport com.databricks.spark.xml\nxmlData = spark.read.format(\"com.databricks.spark.xml\").option(\"rowTag\",\"country name\").load(\"/user/upkar.yadav91412/country_data.xml\")\nxmlData.show(10,false)","user":"upkar.yadav91412","dateUpdated":"2019-02-05T15:57:55+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540897507535_-1788366190","id":"20181030-163507_762518232","dateCreated":"2018-10-30T16:35:07+0530","dateStarted":"2019-02-05T15:57:55+0530","dateFinished":"2019-02-05T15:57:56+0530","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37121"},{"text":"%livy2.pyspark\nfrom pyspark.ml.classification import LogisticRegression","user":"upkar.yadav91412","dateUpdated":"2019-01-31T11:37:08+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542176805116_908565241","id":"20181114-115645_1021874042","dateCreated":"2018-11-14T11:56:45+0530","dateStarted":"2019-01-31T11:37:08+0530","dateFinished":"2019-01-31T11:37:09+0530","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37122"},{"text":"%livy2.pyspark\ndf = sc.parallelize([(1, 2, 3, \"a b c\"), (4, 5, 6, \"d e f\"), (7, 8, 9, \"g h i\")]).toDF(['col1', 'col2', 'col3','col4'])","user":"upkar.yadav91412","dateUpdated":"2018-11-19T11:30:44+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542350901122_1153317216","id":"20181116-121821_1442476929","dateCreated":"2018-11-16T12:18:21+0530","dateStarted":"2018-11-19T11:30:28+0530","dateFinished":"2018-11-19T11:30:29+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37123"},{"text":"%livy2.pyspark\ndf.show()","user":"upkar.yadav91412","dateUpdated":"2018-11-19T11:30:32+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542607173888_556493359","id":"20181119-112933_1094871130","dateCreated":"2018-11-19T11:29:33+0530","dateStarted":"2018-11-19T11:30:32+0530","dateFinished":"2018-11-19T11:30:33+0530","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37124"},{"text":"%livy2.pyspark3\r\nfrom pyspark.sql import Row\r\nimport xml.etree.ElementTree as ET\r\n\r\ndef parser_xml(string_xml):\r\n   root = ET.fromstring(string_xml.encode('ISO-8859-1', errors='replace'))\r\n   ''' Implement all parser logic\r\n   '''\r\n   columnName1 = root.find('test').attrib['value1']\r\n   columnName2 = root.find('test2').attrib['value2']\r\n   columnName3 = root.find('test3').attrib['value3']\r\n\r\n   return row_counter(columnName1, columnName2, columnName3)","user":"upkar.yadav91412","dateUpdated":"2018-11-26T18:10:20+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false,"completionKey":"TAB"},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542607212257_525951198","id":"20181119-113012_2062720144","dateCreated":"2018-11-19T11:30:12+0530","dateStarted":"2018-11-26T18:10:20+0530","dateFinished":"2018-11-26T18:10:21+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37125"},{"text":"%livy2.pyspark3\nfrom pyspark.sql import Row\nimport xml.etree.ElementTree as ET\n\nrdd=ET.parse('yod_test.xml')\nrdd.take(4)\n# rdd=ET.parse(\"/user/upkar.yadav91412/test_b.csv\")\n# # rdd1 = sc.wholeTextFiles(\"yod_test.xml\")\n# xml_string = ET.tostring(rdd.getroot())\n# xml_string.take(10)\n\n# rdd1=ET.parse('/user/upkar.yadav91412/yod_test.xml')\n# print rdd.take(1)\n# data = rdd.map(lambda (string_file): parser_xml(string_file[1])) \n# df = spark.createDataFrame(data, schema=None, samplingRatio=None, verifySchema=True)","user":"upkar.yadav91412","dateUpdated":"2019-01-31T10:56:44+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543235782202_-1859196443","id":"20181126-180622_1785000354","dateCreated":"2018-11-26T18:06:22+0530","dateStarted":"2019-01-31T10:56:45+0530","dateFinished":"2019-01-31T10:57:14+0530","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37126"},{"text":"%livy2.pyspark3\n\n# v1='Hi hi hi bye bye bye word count' \n# rdd=sc.parallelize([v1])\nrdd=sc.textFile('test_b.csv')\n\nwordcounts=rdd.flatMap(lambda l: l.split(';')) \\\n        .map(lambda w:(w,1)) \\\n        .reduceByKey(lambda a,b:a+b) \\\n        .map(lambda (a,b):(b,a)) \\\n        .sortByKey(ascending=False)\n\noutput = wordcounts.collect()\nfor (count,word) in output:\n    print(\"%s: %i\" % (word,count))","user":"upkar.yadav91412","dateUpdated":"2019-01-31T11:39:44+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543236190697_-522218908","id":"20181126-181310_863588002","dateCreated":"2018-11-26T18:13:10+0530","dateStarted":"2019-01-31T11:39:44+0530","dateFinished":"2019-01-31T11:39:51+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37127"},{"text":"%livy2.pyspark3\nDF1=spark.read.csv('sales_info.csv',inferSchema=True,header=True)\nDF1.show()","user":"upkar.yadav91412","dateUpdated":"2018-12-04T16:19:29+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543919458131_709664920","id":"20181204-160058_498148861","dateCreated":"2018-12-04T16:00:58+0530","dateStarted":"2018-12-04T16:19:29+0530","dateFinished":"2018-12-04T16:19:37+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37128"},{"text":"%livy2.pyspark3\nsc.version","user":"upkar.yadav91412","dateUpdated":"2018-12-12T15:46:18+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543919738585_103602623","id":"20181204-160538_637496904","dateCreated":"2018-12-04T16:05:38+0530","dateStarted":"2018-12-12T15:46:18+0530","dateFinished":"2018-12-12T15:46:19+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37129"},{"text":"%livy2.pyspark3\ndf=spark.sql(\"select count(*) from bdp_rl_dm_out.ot_client_behavioural_data\").show()","user":"upkar.yadav91412","dateUpdated":"2018-12-13T18:01:02+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544609720018_801401819","id":"20181212-154520_584425180","dateCreated":"2018-12-12T15:45:20+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37130"},{"text":"%livy2.pyspark3\ndf=spark.sql(\"select code_producer, avg(amt_credit_total) from bdp_rl_dm_uwi.ft_application_at group by code_producer\").show()","user":"upkar.yadav91412","dateUpdated":"2018-12-13T18:02:51+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544704271525_2027040737","id":"20181213-180111_1816008589","dateCreated":"2018-12-13T18:01:11+0530","dateStarted":"2018-12-13T18:02:51+0530","dateFinished":"2018-12-13T18:03:32+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37131"},{"text":"%livy2.pyspark\ndf = spark.sql(\"select skp_client, avg(amt_credit_total_loan_last)  from bdp_rl_dm_uwi.ft_client_pt \\\nwhere name_segm_lvl_1_loan_first = 'PoS Loan Mobile' group by skp_client \").show()\n\n# createOrReplaceTempView(\"TestE\") \n# df1=spark.sql(\"select count(*) from TestE where HIT=1\").show()","user":"upkar.yadav91412","dateUpdated":"2019-01-07T12:44:01+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544704371233_-361905830","id":"20181213-180251_269039523","dateCreated":"2018-12-13T18:02:51+0530","dateStarted":"2019-01-07T12:44:01+0530","dateFinished":"2019-01-07T12:44:18+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37132"},{"text":"%livy2.pyspark\ndata = spark.sql(\"select skp_application,skp_client,amt_income_main from bdp_rl_dm_uwi.ft_application_at\")\ndata1=data.filter(\"amt_income_main>3000\")\ndata1.createOrReplaceTempView(\"ftat\")\ndf=spark.sql(\"select * from ftat\")\ndf.show()","user":"upkar.yadav91412","dateUpdated":"2019-01-31T11:42:04+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1546842391389_547992026","id":"20190107-115631_2031117228","dateCreated":"2019-01-07T11:56:31+0530","dateStarted":"2019-01-31T11:42:04+0530","dateFinished":"2019-01-31T11:42:16+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37133"},{"title":"crif_score_pull","text":"%livy2.pyspark\ndf = spark.sql(\"select cuid,xml_value,part_date from bdp_rl_d_rcmxml.rcmxml_raw_resp \\\nwhere cuid =9917636 and src_name='CRIF' and part_date>20180901 and part_date<20181231\").rdd.coalesce(1).saveAsTextFile('/user/upkar.yadav91412/crif_xml.txt')","user":"upkar.yadav91412","dateUpdated":"2019-02-04T11:01:35+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548406773958_-1663242484","id":"20190125-142933_115554234","dateCreated":"2019-01-25T14:29:33+0530","dateStarted":"2019-01-25T14:34:06+0530","dateFinished":"2019-01-25T14:45:37+0530","status":"ABORT","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37134"},{"text":"%livy2.pyspark\n","user":"upkar.yadav91412","dateUpdated":"2019-01-25T14:30:58+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548406858809_1844147937","id":"20190125-143058_1794699183","dateCreated":"2019-01-25T14:30:58+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37135"}],"name":"test_pyspark","id":"2DR4CXBMS","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"livy2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}